{% extends "base.html" %}

{% block content %}
<h2 class="fw-semibold mb-4">Champaign Apartments</h2>

<!-- SEARCH BAR -->
<form method="get" class="mb-4 d-flex gap-2">
    <input
        type="text"
        name="q"
        class="form-control"
        placeholder="Search by apartment name or address"
        value="{{ query }}"
    >
    <button class="btn btn-primary">Search</button>

    {% if query %}
        <a href="{% url 'champaign-apartments' %}" class="btn btn-outline-secondary">
            Clear
        </a>
    {% endif %}
</form>

{% if error %}
    <p class="text-danger">{{ error }}</p>
{% endif %}

{% if apartments %}
    <div class="row">
        {% for a in apartments %}
            <div class="col-md-4 mb-4">
                <div class="figma-card h-100 p-3">
                    <h5 class="fw-semibold">{{ a.name }}</h5>
                    <p class="text-muted small mb-2">{{ a.address }}</p>

                    {% if a.units %}
                        <p class="small mb-1"><strong>Units:</strong> {{ a.units }}</p>
                    {% endif %}
                    {% if a.stories %}
                        <p class="small"><strong>Stories:</strong> {{ a.stories }}</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- PAGINATION -->
    <nav class="mt-4">
        <ul class="pagination justify-content-center">

            {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link"
                       href="?q={{ query }}&page={{ page_obj.previous_page_number }}">
                        Previous
                    </a>
                </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                </span>
            </li>

            {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link"
                       href="?q={{ query }}&page={{ page_obj.next_page_number }}">
                        Next
                    </a>
                </li>
            {% endif %}

        </ul>
    </nav>

{% else %}
    <p>No apartments found.</p>
{% endif %}
{% endblock %}